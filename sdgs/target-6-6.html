<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Protect and restore water related ecosystems – ./jrfep</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">J.R. Ferrer-Paris</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-my-research" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book-half" role="img">
</i> 
 <span class="menu-text">My research</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-my-research">    
        <li>
    <a class="dropdown-item" href="../CV.html">
 <span class="dropdown-text">Curriculum Vitae</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../my-publications.html">
 <span class="dropdown-text">Peer reviewed publications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../impact-SDG.html">
 <span class="dropdown-text">Sustainable development goals</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-folder-symlink" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-folder-symlink" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-folder-symlink">    
        <li>
    <a class="dropdown-item" href="https://jrfep.github.io/"><i class="bi bi-projector" role="img">
</i> 
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../links.html"><i class="bi bi-eyeglasses" role="img">
</i> 
 <span class="dropdown-text">Read more here</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://jrfep.github.io/esp/"><i class="bi bi-braces-asterisk" role="img">
</i> 
 <span class="dropdown-text">cambiar a Español</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#global-tools" id="toc-global-tools" class="nav-link active" data-scroll-target="#global-tools">Global tools</a></li>
  <li><a href="#continental-progress" id="toc-continental-progress" class="nav-link" data-scroll-target="#continental-progress">Continental progress</a>
  <ul class="collapse">
  <li><a href="#freshwater-ecosystems-in-africa" id="toc-freshwater-ecosystems-in-africa" class="nav-link" data-scroll-target="#freshwater-ecosystems-in-africa">Freshwater ecosystems in Africa</a></li>
  </ul></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case studies</a>
  <ul class="collapse">
  <li><a href="#tropical-glaciers" id="toc-tropical-glaciers" class="nav-link" data-scroll-target="#tropical-glaciers">Tropical glaciers</a></li>
  <li><a href="#upland-swamps-in-australia" id="toc-upland-swamps-in-australia" class="nav-link" data-scroll-target="#upland-swamps-in-australia">Upland swamps in Australia</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jrfep/eng/edit/mostly-harmless/sdgs/target-6-6.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jrfep/eng/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Protect and restore water related ecosystems</h1>
<p class="subtitle lead"><a href="../impact-SDG.html">My contributions to SDGs</a></p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/GOAL_6_TARGET_6.6.svg" class="img-fluid figure-img" width="150"></p>
<figcaption>Target 6.6: By 2020, protect and restore water-related ecosystems, including mountains, forests, wetlands, rivers, aquifers and lakes</figcaption>
</figure>
</div>
<section id="global-tools" class="level2">
<h2 class="anchored" data-anchor-id="global-tools">Global tools</h2>
<p>The <strong>IUCN Global Ecosystem Typology</strong> and the <strong>IUCN Red List of Ecosystems</strong> play crucial roles in achieving Sustainable Development Goal 6 (SDG 6), which focuses on ensuring the availability and sustainable management of water and sanitation for all.</p>
<p>The <strong>IUCN Global Ecosystem Typology</strong> provides a comprehensive function-based classification and support to policy <span class="citation" data-cites="Keith_2022_Ecosystem_Typology">(<a href="#ref-Keith_2022_Ecosystem_Typology" role="doc-biblioref">Keith et al. 2022</a>)</span>.</p>
<p>The typology provides a detailed framework for classifying and mapping all Earth’s ecosystems, including freshwater ecosystems like rivers, lakes, and wetlands. By understanding the functional and compositional features of these ecosystems, we can better manage and protect water resources.</p>
<p>The typology supports global to local policy applications, helping to identify critical ecosystems that are essential for water purification, flood control, and maintaining water cycles. This is vital for implementing effective water management strategies <span class="citation" data-cites="Nicholson_2024">(<a href="#ref-Nicholson_2024" role="doc-biblioref">Nicholson et al. 2024</a>)</span>.</p>
<p>The <strong>IUCN Red List of Ecosystems</strong> is the global standard for risk assessment at the ecosystem level and contributes robust science for measuring the impact of threats, and ecosystem responses to conservation measures <span class="citation" data-cites="IUCN_2024">(<a href="#ref-IUCN_2024" role="doc-biblioref">IUCN 2024</a>)</span>.</p>
<p>The Red List of Ecosystems assesses the conservation status of ecosystems, identifying those at risk of collapse. This includes freshwater ecosystems that are crucial for clean water supply and sanitation. By highlighting these risks, it helps prioritize conservation efforts <span class="citation" data-cites="Bland_2019_Impact_RLE">(<a href="#ref-Bland_2019_Impact_RLE" role="doc-biblioref">Bland et al. 2019</a>)</span>.</p>
<p>It provides a tool for monitoring the state of ecosystems and measuring the impacts of conservation measures. This ongoing assessment is essential for maintaining healthy water ecosystems, which directly supports SDG 6 targets related to water quality and availability.</p>
<p>Together, these tools provide a robust scientific basis for decision-making and policy development. They help identify which ecosystems are most critical for water-related services and which are under threat, enabling targeted conservation and restoration efforts.</p>
<p>By integrating these tools into national and global water management policies, we can ensure the sustainable use and protection of water resources, contributing directly to the achievement of SDG 6.</p>
</section>
<section id="continental-progress" class="level2">
<h2 class="anchored" data-anchor-id="continental-progress">Continental progress</h2>
<section id="freshwater-ecosystems-in-africa" class="level3">
<h3 class="anchored" data-anchor-id="freshwater-ecosystems-in-africa">Freshwater ecosystems in Africa</h3>
<p>Africa is strategically important for ecosystem management due to its high ecosystem diversity, significant pressures, and high human dependency on nature. A symposium at the African Protected Areas Congress discussed the role of the IUCN Red List of Ecosystems in designing and managing protected areas (PCAs).</p>
<p>Africa hosts a significant portion of the world’s freshwater ecosystems, including artesian springs, seasonal floodplains, rivers, and lakes. However, many of these ecosystems remain unevaluated or data deficient. Red-list assessments have been conducted for key freshwater ecosystems in Egypt, the Congo basin, Senegal, Mauritania, and Mozambique <span class="citation" data-cites="RLE_Africa">(<a href="#ref-RLE_Africa" role="doc-biblioref">Keith et al. 2023a</a>)</span>.</p>
</section>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case studies</h2>
<section id="tropical-glaciers" class="level3">
<h3 class="anchored" data-anchor-id="tropical-glaciers">Tropical glaciers</h3>
<p>Tropical glaciers play a role in the local and regional cycles of water and energy. The glaciers in the top of tropical mountains store vast amounts of freshwater in the form of ice. During warmer months, the melting ice provides a steady flow of water to rivers and streams, contributing to downstream needs for drinking water, agriculture, and hydropower.</p>
<p>These ecosystems support unique micro- and meso-biota adapted to cold environments. The meltwater from glaciers also contributes nutrients and propagules to downstream ecosystems.</p>
<p>Many communities rely on glacier-fed rivers for their livelihoods, including agriculture, fishing, and tourism. The consistent water supply from glaciers is vital for these economic activities.</p>
<p>Detailed spatial analyses of the rates of changes of tropical glaciers in the Andes and other tropical mountains can inform regional and local strategies for monitoring, management, and conservation, benefiting both people and nature.</p>
<p>Our work supports SDG 6.6 by offering methods to evaluate and mitigate risks to water-related ecosystems, ensuring their sustainability and resilience <span class="citation" data-cites="FerrerParis_Glacier_suitability FerrerParis_Glacier_Merida_2024">(<a href="#ref-FerrerParis_Glacier_Merida_2024" role="doc-biblioref">Ferrer-Paris et al. 2024</a>; <a href="#ref-FerrerParis_Glacier_suitability" role="doc-biblioref">Ferrer-Paris and Keith 2024</a>)</span>.</p>
</section>
<section id="upland-swamps-in-australia" class="level3">
<h3 class="anchored" data-anchor-id="upland-swamps-in-australia">Upland swamps in Australia</h3>
<p>We studied groundwater-dependent, peat-accumulating, fire-prone wetlands known as upland swamps in southeastern Australia <span class="citation" data-cites="Keith_2022_Resilience_Swamps">(<a href="#ref-Keith_2022_Resilience_Swamps" role="doc-biblioref">Keith et al. 2023b</a>)</span>.</p>
<p>The study investigated how underground mining affects the resilience of groundwater-dependent wetlands in southeastern Australia to landscape fires. We monitored soil moisture and compared the responses of mined and unmined swamps after fires. We found that mined swamps experienced a significant decline in soil moisture and showed strong symptoms of ecosystem collapse, such as loss of peat, reduced vegetation, and altered species composition. In contrast, unmined swamps maintained soil moisture and regenerated vigorously after fires.</p>
<p>Our findings highlight the importance of early diagnosis and preventative measures to avoid ecosystem collapse due to anthropogenic stressors.</p>
<hr>
<p>Check my contributions to <a href="../impact-SDG.html">other targets</a>!</p>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-FerrerParis_Glacier_suitability" class="csl-entry" role="listitem">
Ferrer-Paris, J. R., and Keith, D. A. (2024), <span>"<a href="https://doi.org/10.1016/j.ecolind.2024.111790">Trade-offs in the use of direct and indirect indicators of ecosystem degradation for risk assessment</a>"</span> <em>Ecological Indicators</em>, 160, 111790.
</div>
<div id="ref-FerrerParis_Glacier_Merida_2024" class="csl-entry" role="listitem">
Ferrer-Paris, J. R., Llambí, L. D., Melfo, A., and Keith, D. (2024), <span>"<a href="https://doi.org/10.1017/S0030605323001771">First red list of ecosystems assessment of a tropical glacier ecosystem to diagnose the pathways toward imminent collapse</a>"</span> <em>Oryx</em>, Published online, 1–11.
</div>
<div id="ref-IUCN_2024" class="csl-entry" role="listitem">
IUCN. (2024), <em><a href="https://doi.org/10.2305/cjdf9122"><span class="nocase">Guidelines for the application of IUCN Red List of Ecosystems Categories and Criteria: version 2.0</span></a></em>, (D. A. Keith, J. R. Ferrer-Paris, S. M. M. Ghoraba, S. Henriksen, M. Monyeki, N. J. Murray, E. Nicholson, J. Rowland, A. Skowno, J. A. Slingsby, A. B. Storeng, M. Valderrábano, and I. Zager, eds.), Gland, Switzerland, IUCN, xii, 162p. : ill.
</div>
<div id="ref-Nicholson_2024" class="csl-entry" role="listitem">
Nicholson, E., Andrade, A., Driver, A., Ferrer-Paris, J. R., Keith, D., Sievers, M., and Stevenson, S. (2024), <span>"<a href="https://doi.org/10.1038/s41559-023-02320-5">Beyond the headline: Roles of the red list of ecosystems in implementing the kunming-montreal global biodiversity framework</a>"</span> <em>Nature Ecology and Evolution</em>.
</div>
<div id="ref-RLE_Africa" class="csl-entry" role="listitem">
Keith, D. A., Ghoraba, S. M. M., Kaly, E., Jones, K. R., Oosthuizen, A., Obura, D., Costa, H. M., Daniels, F., Duarte, E., Grantham, H., Gudka, M., Norman, J., Shannon, L. J., Skowno, A., and Ferrer-Paris, J. R. (2023a), <span>"<a href="https://doi.org/10.1111/cobi.14169">Contributions of red lists of ecosystems to risk-based design and management of protected and conserved areas in africa</a>"</span> <em>Conservation Biology</em>.
</div>
<div id="ref-Keith_2022_Resilience_Swamps" class="csl-entry" role="listitem">
Keith, D., Benson, D., Baird, I., Watts, L., Simpson, C., Krogh, M., Gorissen, S., Ferrer-Paris, J. R., and Mason, T. (2023b), <span>"<a href="https://doi.org/10.1111/cobi.13995">Effects of interactions between anthropogenic stressors and recurring perturbations on ecosystem resilience and collapse</a>"</span> <em>Conservation Biology</em>, 37, e13995.
</div>
<div id="ref-Keith_2022_Ecosystem_Typology" class="csl-entry" role="listitem">
Keith, D. A., Ferrer-Paris, J. R., Nicholson, E., Bishop, M. J., Polidoro, B. A., Ramirez-Llodra, E., Tozer, M. G., Nel, J. L., Mac Nally, R., Gregr, E. J., Watermeyer, K. E., Essl, F., Faber-Langendoen, D., Franklin, J., Lehmann, C. E. R., Etter, A., Roux, D. J., Stark, J. S., Rowland, J. A., Brummitt, N. A., Fernandez-Arcaya, U. C., Suthers, I. M., Wiser, S. K., Donohue, I., Jackson, L. J., Pennington, R. T., Iliffe, T. M., Gerovasileiou, V., Giller, P., Robson, B. J., Pettorelli, N., Andrade, A., Lindgaard, A., Tahvanainen, T., Terauds, A., Chadwick, M. A., Murray, N. J., Moat, J., Pliscoff, P., Zager, I., and Kingsford, R. T. (2022), <span>"<a href="https://doi.org/10.1038/s41586-022-05318-4">A function-based typology for earth’s ecosystems</a>"</span> <em>Nature</em>, 610, 513–518.
</div>
<div id="ref-Bland_2019_Impact_RLE" class="csl-entry" role="listitem">
Bland, L. M., Nicholson, E., Miller, R. M., Andrade, A., Carré, A., Etter, A., Ferrer-Paris, J. R., Herrera, B., Kontula, T., Lindgaard, A., Pliscoff, P., Skowno, A., Valderrábano, M., Zager, I., and Keith, D. A. (2019), <span>"<a href="https://doi.org/10.1111/conl.12666">Impacts of the IUCN red list of ecosystems on conservation policy and practice</a>"</span> <em>Conservation Letters</em>, 12, 5, e12666.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/jrfep\.github\.io\/eng\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jrfep/eng/edit/mostly-harmless/sdgs/target-6-6.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jrfep/eng/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>